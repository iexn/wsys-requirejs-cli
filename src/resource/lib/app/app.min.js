function app(e,n){function t(t,i){return i=n.extend({},{before:function(){},done:function(){},fail:function(){}},i),i.before()!==!1&&void n.post(t,{url:location.href}).then(function(t){return 0!=t.errno?(i.fail(t.message,t.data),!1):(m.sysinfo=p=t.data,m.$=n,e.config(t.data.account.jssdkconfig),void i.done())}).fail(function(){i.fail(!1)})}function i(){e.hideAllNonBaseMenuItem(),e.showMenuItems({menuList:["menuItem:share:appMessage","menuItem:share:timeline","menuItem:share:brand"]})}function o(n){e.ready(function(){i(),n&&n(e)})}function a(e,t,i,o){var a=p.siteroot+"app/index.php",s=o||a,r={};return r.i=p.acid,r.c="entry",r.do=e,r.m=p.module.name,r=n.extend({},r,t),c(s,r,i)}function c(e,n,t){var i=e||"",o=[];for(var a in n)o.push(a+"="+encodeURI(n[a]));return i+="?"+o.join("&"),"undefined"!=typeof t&&(i+="#"+t),i}function s(t,i){i=n.extend({},{text:!0,type:2},i);var o;switch(i.type){case 1:o=["barCode"];break;case 2:o=["qrCode"];break;case 0:default:o=["qrCode","barCode"]}e.ready(function(){e.scanQRCode({needResult:0==i.text?0:1,scanType:o,success:function(e){"scanQRCode:ok"==e.errMsg?t&&t(e.resultStr):console.log("扫码识别错误，请重新尝试")}})})}function r(t){t=n.extend({},{fee:"",title:"",sn:"",done:function(){},cancel:function(){},fail:function(){}},t),n.post("index.php?i="+p.uniacid+"&j="+p.acid+"&c=entry&m=core&do=pay&iswxapp=0",{method:"wechat",tid:t.sn,title:t.title,fee:t.fee,module:p.module.name},function(i){if("string"==typeof i&&(i=n.parseJSON(i)),0!=i.message.errno)return t.fail(i.message),!1;var o=i.message.message;e.chooseWXPay({timestamp:o.timeStamp,nonceStr:o.nonceStr,package:o.package,signType:o.signType,paySign:o.paySign,success:function(e){t.done()},cancel:function(){t.cancel()},fail:function(){t.fail(!1)}})})}function u(t){g=!0,t=n.extend({},{title:"",desc:"",imgUrl:"",link:location.href,done:function(){}},t),e.updateAppMessageShareData({title:t.title,desc:t.desc,imgUrl:t.imgUrl,link:location.href,success:function(e){d(t.done,e)}}),e.onMenuShareAppMessage({title:t.title,desc:t.desc,imgUrl:t.imgUrl,link:location.href,success:function(e){d(t.done,e)}})}function d(e,n){g&&e(n),g=!1}function f(t){h=!0,t=n.extend({},{title:"",desc:"",imgUrl:"",link:location.href,done:function(){}},t),e.updateTimelineShareData({title:t.title,desc:t.desc,imgUrl:t.imgUrl,link:location.href,success:function(e){l(t.done,e)}}),e.onMenuShareTimeline({title:t.title,desc:t.desc,imgUrl:t.imgUrl,link:location.href,success:function(e){l(t.done,e)}})}function l(e,n){h&&e(n),h=!1}var p={},m={},g=!0,h=!0;return m.init=t,m.ready=o,m.wx={scan:s,pay:r,shareMessage:u,shareTimeline:f},m.web2app_url=a,m}define(["wx","jquery"],app);